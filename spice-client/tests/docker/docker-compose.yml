version: '3.8'

services:
  spice-server:
    build:
      context: .
      dockerfile: Dockerfile.spice-server
    image: spice-test-server:latest
    container_name: spice-test-server
    ports:
      - "5900-5910:5900-5910"
    environment:
      - SPICE_DEBUG_LEVEL=5
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "5900"]
      interval: 5s
      timeout: 3s
      retries: 10
      start_period: 10s
    networks:
      - spice-test-net

networks:
  spice-test-net:
    driver: bridge